#!/usr/bin/env node
'use strict'

var cloud = require('../lib/cloud')

const imaginator = require('../lib/imaginator')
imaginator.start({
  whitelist (item, cb) {
    cloud.get('whitelist', function (err, whitelistJson) {
      if (err) {
        cb(err)
      } else {
        let whitelist = JSON.parse(whitelistJson)
        if (whitelist) {
          cb(null, !!whitelist[item])
        } else {
          cb(null, false)
        }
      }
    })
  }
}, function (err, server) {
  if (err) {
    throw err
  }
  console.log('Listening on port ' + server.address().port)
})
